{% extends 'base.html' %} {% block page_header_title %}Water Quality Data{%
  endblock %} {% block page_content %}
  
  <div id="page-content">
    <div id="app">
      <form role="form" id="params" name="params" autocomplete="off" method="post" action="
                          {%  if config.WATERAUTH_AUTHORIZE_URL %}
                            {{ url_for('portal_ui.wqp_download_proxy', op='Station')}}
                          {%  else %}
                            {{ config.SEARCH_QUERY_ENDPOINT }}Station/search
                            {% endif %}
                            ">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
        <div id="place">
          <div class="grid-col">
            <div class="usa-accordion">
              <h4 class="usa-accordion__heading">
                <button class="usa-accordion__button" aria-expanded="true" aria-controls="a1">
                  Select Location Parameters
                </button>
              </h4>
              <div id="a1" class="usa-accordion__content usa-prose">
                <div class="grid-row grid-gap">
                  <div class="tablet:grid-col">
                    <div class="form-group">
                      <label for="countrycode" class="tooltip" :title="countryTooltip"><strong>Country</strong></label>
                      <div>
                        <select multiple class="form-control" id="countrycode" name="countrycode" data-placeholder="All"
                          style="width: 100%"></select>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="tooltip" for="statecode" :title="stateTooltip"><strong>State</strong></label>
                      <div>
                        <select multiple class="form-control" id="statecode" name="statecode" data-placeholder="All"
                          style="width: 100%"></select>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="tooltip" class="control-label" for="countycode" :title="countyTooltip"><strong>County</strong></label>
                      <div>
                        <select multiple class="form-control" id="countycode" name="countycode" data-placeholder="All"
                          style="width: 100%"></select>
                      </div>
                    </div>
                  </div>
                  <div class="tablet:grid-col">
                    <div id="point-location">
                      <div>
                        <label class="tooltip" :title="pointLocationTooltip"><strong>Point Location</strong></label>
                      </div>
                      <div>
                        <div class="form-group">
                          <label class="control-label" for="within">Within</label>
                          <div>
                            <input class="form-control" type="text" name="within" id="within" />
                          </div>
                        </div>
                        <div id="miles-label">miles of</div>
                        <div class="form-group">
                          <label class="control-label" for="lat">Lat</label>
                          <div>
                            <input class="form-control" type="text" name="lat" size="7" id="lat" />
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="control-label" for="long">Long</label>
                          <div>
                            <input class="form-control" type="text" name="long" id="long" />
                          </div>
                        </div>
                        <svg class="usa-icon" aria-hidden="true" focusable="false" role="img">
                          <use xlink:href="{{ 'img/sprite.svg#my_location' | asset_url }}"></use>
                        </svg>
                        <div id="useMyLocation"></div>
                      </div>
                    </div>
                  </div>
                  <div class="tablet:grid-col">
                    <div id="bounding-box" class="tooltip" :title="boundingBoxTooltip">
                      <div><strong>Bounding Box</strong></div>
                      <div>
                        <div class="form-group">
                          <label class="control-label" for="north">North:</label>
                          <div>
                            <input class="form-control" type="text" id="north" />
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="control-label" for="south">South:</label>
                          <div>
                            <input class="form-control" type="text" id="south" />
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="control-label" for="east">East:</label>
                          <div>
                            <input class="form-control" type="text" id="east" />
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="control-label" for="west">West:</label>
                          <div>
                            <input class="form-control" type="text" id="west" />
                          </div>
                        </div>
                      </div>
                      <input type="hidden" name="bBox" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="siteSamplingParams">
          <div class="grid-col">
            <div class="usa-accordion">
              <h4 class="usa-accordion__heading">
                <button class="usa-accordion__button" aria-expanded="true" aria-controls="a2">
                  Select Site & Sampling Parameters
                </button>
              </h4>
              <div id="a2" class="usa-accordion__content usa-prose">
                <div id="site-params">
                  <div class="grid-row grid-gap">
                    <div class="tablet:grid-col">
                      <div class="tooltip" :title="siteTypeTooltip">
                        <label class="control-label" for="siteType"><strong>Site Type</strong></label>
                        <div>
                          <select multiple id="siteType" name="siteType" data-placeholder="All"
                            style="width: 90%"></select>
                        </div>
                      </div>
                      <div class="tooltip" :title="orgIDTooltip">
                        <label class="control-label" for="organization"><strong>Organization ID</strong></label>
                        <div>
                          <select multiple id="organization" name="organization"
                            data-placeholder="All" style="width: 84%"></select>
                        </div>
                      </div>
                      <div class="tooltip" data-position="right" :title="siteIDTooltip">
                        <label class="control-label" for="siteid"><strong>Site ID</strong></label>
                        <div>
                          <select multiple id="siteid" name="siteid" data-placeholder="All"
                            style="width: 70%"></select>
                        </div>
                      </div>
                      <div class="tooltip" :title="hucTooltip">
                        <label class="control-label" for="huc"><strong>HUC</strong></label>
                        <div>
                          <input class="form-control" type="text" name="huc" id="huc" data-multiple="true" />
                        </div>
                      </div>
                    </div>
                    <div class="tablet:grid-col">
                      <div id="sampling-params" class="panel panel-default">
                        <div class="panel-body">
                          <div id="sampling" class="subpanel">
                            <div class="subpanel-body">
                              <div class="tooltip" :title="sampleMediaTooltip">
                                <label class="control-label" for="sampleMedia"><strong>Sample Media</strong></label>
                                <div>
                                  <select multiple class="form-control" name="sampleMedia" id="sampleMedia"
                                    data-placeholder="All" style="width: 100%"></select>
                                </div>
                              </div>
                              <div class="tooltip" :title="charGroupTooltip">
                                <label class="control-label" for="characteristicType"><strong>Characteristic Group</strong></label>
                                <div>
                                  <select multiple class="form-control" name="characteristicType" id="characteristicType"
                                    data-placeholder="All" style="width: 100%"></select>
                                </div>
                              </div>
                              <div class="tooltip" :title="characteristicsTooltip">
                                <label class="control-label" for="characteristicName"><strong>Characteristics</strong></label>
                                <div>
                                  <select multiple class="form-control" name="characteristicName" id="characteristicName"
                                    data-placeholder="All" style="width: 100%"></select>
                                </div>
                              </div>
  
                              <div class="tooltip" :title="projectIDTooltip">
                                <label class="control-label" for="project-code"><strong>Project ID</strong></label>
                                <div>
                                  <select multiple class="form-control" name="project" id="project-code"
                                    data-placeholder="All" style="width: 100%"></select>
                                </div>
                              </div>
                              <div class="tooltip" id="pcode-div" :title="paramCodeTooltip">
                                <label class="control-label" for="pCode"><strong>Parameter Code</strong>
                                  <span style="font-size: x-small">(NWIS ONLY)</span></label>
                                <div>
                                  <input class="form-control usa-label" type="text" name="pCode" id="pCode"
                                    data-multiple="true" />
                                </div>
                              </div>
                          <div id="biological" class="subpanel">
                            <div class="tooltip" :title="bioSamplingTooltip">
                            <div class="subpanel-heading">
                              <strong>Biological Sampling Parameters</strong>
                            </div>
                          </div>
                            <div class="subpanel-body">
                              <div class="tooltip" :title="assemblageTooltip">
                                <label for="assemblage"><strong>Assemblage</strong></label>
                                <div>
                                  <select multiple name="assemblage" id="assemblage"
                                    data-placeholder="All" style="width: 100%"></select>
                                </div>
                              </div>
                              <div class="form-group">
                                <label class="tooltip" for="subjectTaxonomicName" :title="taxNameTooltip"><strong>Taxonomic
                                  Name</strong></label>
                                <div>
                                  <select multiple name="subjectTaxonomicName" aria-label="Select a taxonomic name"
                                    id="subject-taxonomic-name" data-placeholder="All" style="width: 100%"></select>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="grid-col">
          <div class="usa-accordion">
            <h4 class="usa-accordion__heading">
              <button class="usa-accordion__button" aria-expanded="true" aria-controls="a3">
                Filter Results
              </button>
            </h4>
            <div id="a3" class="usa-accordion__content usa-prose">
              <div>
                <div id="filter-box" class="grid-row grid-gap">
                  <div id="filter-box-input-div" class="grid-row grid-gap">
                    <div id="date-row-parameters-div" class="tablet:grid-col-4">
                      <div id="date-row">
                        <div id="start-date-select">
                          <div class="tooltip" :title="dateRangeTooltip">
                            <label for="startDateLo"><strong>Date range</strong> - from:</label>
                          </div>
                              <div>
                                <div>
                                  <input class="form-control usa-label" type="text" id="startDateLo"
                                  name="startDateLo" placeholder="mm-dd-yyyy" />
                                </div>
                              </div>
                            </div>
                        <div id="end-date-select">
                          <label class="control-label" for="startDateHi">to:</label>
                          <div>
                            <div>
                              <input class="form-control usa-label" type="text" id="startDateHi"
                                name="startDateHi" placeholder="mm-dd-yyyy" />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                      <div id="min-activities-parameters-div" class="tablet:grid-col-4">
                        <div class="tooltip" id="min-activities-div" :title="minSamplingTooltip">
                          <label class="control-label" for="min-activities"><strong>Minimum sampling activities per site</strong></label>
                          <div>
                            <input class="form-control" type="number" min="1" name="minactivities" id="min-activities" />
                          </div>
                        </div>
                      </div>
                      <div id="min-results-parameters-div" class="tablet:grid-col-4">
                        <div class="tooltip" id="minresults-div" :title="minimumResultsTooltip">
                          <label class="control-label" for="minresults"><strong>Minimum results per site</strong></label>
                          <div>
                            <input class="form-control usa-label" type="number" min="1" name="minresults"
                              id="minresults" />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <div class="grid-col">
          <div class="usa-accordion">
            <h4 class="usa-accordion__heading">
              <button class="usa-accordion__button" aria-expanded="true" aria-controls="a4">
                Download the Data
              </button>
            </h4>
            <div id="a4" class="usa-accordion__content usa-prose">
              <div>
                <div id="download-box" class="grid-row grid-gap">
                  <div id="download-box-input-div" class="grid-row grid-gap">
                    <div id="data-type-parameters-div" class="tablet:grid-col-3">
                      <div id="databases-row">
                        <div id="select">
                          <fieldset class="usa-fieldset">
                            <div class="tooltip" :title="databasesTooltip">
                              <label for="dataSource"><strong>Data Source</strong></label>
                            </div>
                            <div class="usa-checkbox">
                              <input class="datasources usa-checkbox__input" id="nwis" type="checkbox" name="providers"
                                value="NWIS" checked />
                              <label class="usa-checkbox__label" for="nwis">NWIS</label>
                            </div>
                            <div class="usa-checkbox">
                              <input class="datasources usa-checkbox__input" id="stewards" type="checkbox"
                                name="providers" value="STEWARDS" checked />
                              <label class="usa-checkbox__label" for="stewards">STEWARDS</label>
                            </div>
                            <div class="usa-checkbox">
                              <input class="datasources usa-checkbox__input" id="stortet" type="checkbox" name="providers"
                                value="EPA" checked />
                              <label class="usa-checkbox__label" for="stortet">EPA</label>
                            </div>
                          </fieldset>
                        </div>
                      </div>
                    </div>
                    <div id="download-data-kind-box" class="tablet:grid-col-5">
                      <div class="tooltip" id="download-data-div" :title="dataDownloadTooltip">
                        <label class="control-label" for="dataSource"><strong>Data to Download</strong></label>
                      </div>
                      <fieldset class="usa-fieldset">
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="organization" type="radio"
                            value="Organization" />
                          <label class="usa-radio__label" for="organization">Organization Data</label>
                        </div>
                        <div class="usa-radio">
                          <input checked="checked" type="radio" class="result-type usa-radio__input" id="sites"
                            type="radio" value="Station" />
                          <label class="usa-radio__label" for="sites">Site data only</label>
                        </div>
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="projects" type="radio" value="Project" />
                          <label class="usa-radio__label" for="projects">Project data</label>
                        </div>
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="proj-mon-weight" type="radio"
                            value="ProjectMonitoringLocationWeighting" />
                          <label class="usa-radio__label" for="proj-mon-weight">Project Monitoring Location Weighting
                            data</label>
                        </div>
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="samples" type="radio" value="Result" />
                          <label class="usa-radio__label" for="samples">Sample results (physical/chemical
                            metadata)</label>
                        </div>
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="biosamples" type="radio" value="Result" />
                          <label class="usa-radio__label" for="biosamples">Sample results (biological metadata)</label>
                        </div>
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="narrowsamples" type="radio" value="Result" />
                          <label class="usa-radio__label" for="narrowsamples">Sample results (narrow)</label>
                        </div>
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="activity-input" type="radio" value="Activity" />
                          <label class="usa-radio__label" for="activity-input">Sampling Activity</label>
                        </div>
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="activitymetric-input" type="radio"
                            value="ActivityMetric" />
                          <label class="usa-radio__label" for="activitymetric-input">Sampling Activity Metrics</label>
                        </div>
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="resultdetection" type="radio"
                            value="ResultDetectionQuantitationLimit" />
                          <label class="usa-radio__label" for="resultdetection">Result Detection Quantitation Limit
                            Data</label>
                        </div>
                        <div class="usa-radio">
                          <input class="result-type usa-radio__input" id="biologicalHabitatMetric" type="radio"
                            value="biologicalHabitatMetric" />
                          <label class="usa-radio__label" for="biologicalHabitatMetric">Biological Habitat Metrics</label>
                        </div>
                      </fieldset>
                    </div>
                    <div id="map-and-query-div" class="tablet:grid-col-4">
                      <div id="mapping-div" class="panel-body">
                        <div id="map-ops-button-div" class="form-inline">
                          <div id="show-on-map-button-div" class="form-group">
                            <button type="button" class="usa-button usa-button--outline" id="show-on-map-button">
                              Show Sites on Map
                            </button>
                          </div>
                          <div id="sld-select-div" class="usa-label">
                            <label><strong>Style sites</strong>&nbsp;</label>
                            <select id="sld-select-input" class="usa-select">
                              {% for sld in config.SITE_SLDS %}
                              <option value="{{ sld.id }}" {% if loop.first %}checked{% endif %}>
                                {{ sld.text }}
                              </option>
                              {% endfor %}
                            </select>
                          </div>
                        </div>
                        <div id="query-map-container">
                          <div id="query-results-map"></div>
                          <div id="map-loading-indicator">
                            <i class="fa fa-spin fa-spinner fa-5x"></i>
                          </div>
                          <div id="map-popover" title="Detailed site information" data-trigger="focus"></div>
                        </div>
                      </div>
                      <div id="download-tabular-data">
                        <fieldset class="usa-fieldset">
                          <div class="tooltip" :title="fileFormatTooltip">
                            <label for="dataSource"><strong>File Format</strong></label>
                          </div>
                          <div class="usa-radio">
                            <input class="usa-radio__input" id="csv" type="radio" name="mimeType" value="csv"
                              checked="checked" />
                            <label class="usa-radio__label" for="csv">Comma-separated</label>
                          </div>
                          <div class="usa-radio">
                            <input class="usa-radio__input" id="tsv" type="radio" name="mimeType" value="tsv" />
                            <label class="usa-radio__label" for="tsv">Tab-separated</label>
                          </div>
                          <div class="usa-radio">
                            <input class="usa-radio__input" id="xlsx" type="radio" name="mimeType" value="xlsx" />
                            <label class="usa-radio__label" for="xlsx">MS Excel 2007+</label>
                          </div>
                        </fieldset>
                      </div>
                      <div id="download-sorted-data-div">
                        <input class="control-label" type="checkbox" id="sorted" />
                        <div class="tooltip" :title="sortDataTooltip">
                          <label class="control-label" for="sorted"><strong>Sort data</strong></label>
                        </div>
                      <input type="hidden" name="zip" id="zip" value="yes" />
                      <input type="hidden" name="sorted" id="hidden-sorted" value="no" />
                      </div>
                      <div id="form-action">
                        <a href="#download-status-modal" id="main-button" class="usa-button" type="submit" aria-controls="example-modal-1">
                          DOWNLOAD
                        </a>
                        <div class="usa-modal" id="download-status-modal" aria-labelledby="modal-1-heading" aria-describedby="modal-1-description">
                          <div class="usa-modal__content">
                            <div class="usa-modal__main">
                              <h2 class="usa-modal__heading" id="modal-2-heading">
                                Are you sure you want to continue?
                              </h2>
                              <div class="usa-prose">
                                <p id="modal-2-description">You have unsaved changes that will be lost.</p>
                              </div>
                              <div class="usa-modal__footer">
                                <ul class="usa-button-group">
                                  <li class="usa-button-group__item">
                                      <button type="button" class="usa-button" data-close-modal>Continue without saving</button>
                                    </li>
                                  <li class="usa-button-group__item">
                                      <button type="button" class="usa-button usa-button--unstyled padding-105 text-center" data-close-modal>Go back</button>
                                    </li>
                                  </ul>
                              </div>
                            </div>
                            <button class="usa-button usa-modal__close" aria-label="Close this window" data-close-modal>
                              
                        <svg class="usa-icon" aria-hidden="true" focusable="false" role="img">
                          <use xlink:href="/assets/img/sprite.svg#close"></use>
                        </svg>
                      
                              </button>
                            </div>
                        </div>
                        <div class="share-container" style="padding-top: 5px;">
                          <button type="button" class="usa-button usa-button--outline">
                            Copy Current URL
                          </button>
                          <!-- <textarea class="usa-textarea" readonly rows="3"></textarea> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="grid-col">
          <div class="usa-accordion">
            <h4 class="usa-accordion__heading">
              <button class="usa-accordion__button" aria-expanded="true" aria-controls="a5">
                Show Queries
              </button>
            </h4>
            <div id="a5" class="usa-accordion__content usa-prose">
              <div id="show-queries-div" class="grid-col">
                <a href="#arcgis-online-modal" class="usa-button usa-button--outline" id="show-arcgis-online-help" type="button" aria-controls="arcgis-online-modal" data-open-modal>
                  Show ArcGIS Online Parameters
                </a>
                <div class="usa-modal usa-modal--lg" id="arcgis-online-modal" aria-labelledby="modal-2-heading" aria-describedby="modal-2-description">
                  <div class="usa-modal__content">
                    <div class="usa-modal__main">
                      <h2 class="usa-modal__heading" id="modal-2-heading">
                        Are you sure you want to continue?
                      </h2>
                      <div class="usa-prose">
                        <p id="modal-2-description">You have unsaved changes that will be lost.</p>
                      </div>
                      <div class="usa-modal__footer">
                        <ul class="usa-button-group">
                          <li class="usa-button-group__item">
                              <button type="button" class="usa-button" data-close-modal>Continue without saving</button>
                            </li>
                          <li class="usa-button-group__item">
                              <button type="button" class="usa-button usa-button--unstyled padding-105 text-center" data-close-modal>Go back</button>
                            </li>
                          </ul>
                      </div>
                    </div>
                    <button class="usa-button usa-modal__close" aria-label="Close this window" data-close-modal>
                      
                <svg class="usa-icon" aria-hidden="true" focusable="false" role="img">
                  <use xlink:href="/assets/img/sprite.svg#close"></use>
                </svg>
              
                      </button>
                    </div>
                </div>
                &nbsp;
                <button class="usa-button usa-button--outline" id="show-queries-button" type="button">
                  Show Web Service Calls
                </button>
                &nbsp;
                <div id="api-queries-div">
                  <div class="show-query-text" id="query-div">
                    <b></b>
                    <br />
                    <textarea class="usa-textarea" readonly="readonly" rows="6"></textarea>
                  </div>
                  <div class="show-query-text" id="curl-query-div">
                    <b>cURL</b>
                    <br />
                    <textarea class="usa-textarea" readonly="readonly" rows="6"></textarea>
                  </div>
                  <div class="show-query-text" id="getfeature-query-div">
                    <b>WFS GetFeature</b>
                    <br />
                    <textarea class="usa-textarea" readonly="readonly" rows="6"></textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  <!-- Commented out modals for now -->
  <!-- <div id="download-status-modal" class="modal fade">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">
            &times;
          </button>
          <h4></h4>
        </div>
        <div class="modal-body"></div>
        <div class="modal-footer"></div>
      </div>
    </div>
  </div>
  <div id="arcgis-online-modal" class="modal fade">
    <div class="modal-dialog model-sm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">x</button>
          <h4></h4>
        </div>
        <div class="modal-body"></div>
        <div class="modal-footer"></div>
      </div>
    </div>
  </div>
 <div id="validate-download-dialog" class="modal fade">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">
            &times;
          </button>
          <h4>Invalid Form Input</h4>
        </div>
        <div class="modal-body"></div>
        <div class="modal-footer">
          <button id="validate-close-button" type="button" class="btn btn-default" data-dismiss="modal">
            Ok
          </button>
        </div>
      </div>
    </div>
  </div>
  <div id="service-error-dialog" class="modal fade">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">
            &times;
          </button>
          <h4>Error</h4>
        </div>
        <div class="modal-body">
          Unable to connect to the Water Quality Portal. To report the issue,
          please
          <a href="/contact_us/?comments=Unable to initialize the download form.">contact us</a>.
        </div>
        <div class="modal-footer">
          <button id="validate-close-button" type="button" class="btn btn-default" data-dismiss="modal">
            Ok
          </button>
        </div>
      </div>
    </div>
  </div> -->
  {% endblock %} {% block body_page_script %}
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  <script type="text/javascript" src="{{ 'scripts/portal.js' | asset_url }}"></script>
  {% endblock %}